# JUnits5


ìš°í…Œì½” 2ì£¼ì°¨ ë¯¸ì…˜ì—ì„œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì§œì•¼í•˜ëŠ” ìš”êµ¬ì¡°ê±´ì´ ë‚˜ì™”ë‹¤.

ìš°ì„  ê°œê´„ì ì¸ ì´í•´ë¥¼ ìœ„í•´ í…Œì½”í†¡ ì˜ìƒì„ ì‹œì²­í•˜ë©° ì •ë¦¬í•´ë³¸ë‹¤.

[[10ë¶„ í…Œì½”í†¡] ğŸŒŠ ë°”ë‹¤ì˜ JUnit5 ì‚¬ìš©ë²•](https://youtu.be/EwI3E9Natcw)


## í•„ìˆ˜ ì°¸ê³  ì‚¬ì´íŠ¸
- JUnit ê³µì‹ë¬¸ì„œ
    - JUnit 5 User Guide
    - https://junit.org/junit5/docs/current/user-guide/#overview
- ìš°í˜• ê°œë°œì Github TIL
    - JUnit
    - https://github.com/binghe819/TIL/blob/master/Test/JUnit/JUnit5.md


## 1. JUnit?
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬

### JUnit5
- JUnit Platform ìœ„ì— Jupiter APIë¥¼ í†µí•´ êµ¬ë™
    - Platform : í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ëŸ°ì²˜ ì œê³µ. TestEngine API ì œê³µ
    - Jupiter : JUnit5ë¥¼ ì§€ì›í•˜ëŠ” TestEngine API êµ¬í˜„ì²´

---

## 2. Annotations

### 2-1. `@Test` annot.
- í…ŒìŠ¤íŠ¸ ë©”ì„œë“œë¼ëŠ” ê²ƒì„ ë‚˜íƒ€ë‚´ëŠ” ì–´ë…¸í…Œì´ì…˜
- JUnit4ì™€ ë‹¤ë¥´ê²Œ ì–´ë– í•œ ì†ì„±ë„ ì„ ì–¸í•˜ì§€ ì•ŠëŠ”ë‹¤.

```Java
// JUnit4
@Test(expected = Exception.class)
void create() throws Exception {
    ...
}

// JUnit5
@Test
void create() {
    ...
}
```

### 2-2. ìƒëª…ì£¼ê¸°(LifeCycle) annot.
- `@BeforeAll` : í•´ë‹¹ `í´ë˜ìŠ¤`ì— ìœ„ì¹˜í•œ ëª¨ë“  í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ **ì‹¤í–‰ ì „ì— ë”± í•œ ë²ˆ** ì‹¤í–‰ë˜ëŠ” ë©”ì„œë“œ
- `@AfterAll` : í•´ë‹¹ `í´ë˜ìŠ¤`ì— ìœ„ì¹˜í•œ ëª¨ë“  í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ **ì‹¤í–‰ í›„ì— ë”± í•œ ë²ˆ** ì‹¤í–‰ë˜ëŠ” ë©”ì„œë“œ

<br>

- `@BeforeEach`: í•´ë‹¹ `í´ë˜ìŠ¤`ì— ìœ„ì¹˜í•œ ëª¨ë“  í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì‹¤í–‰ ì „ì— ì‹¤í–‰ë˜ëŠ” ë©”ì„œë“œ
- `@AfterEach` : í•´ë‹¹ `í´ë˜ìŠ¤`ì— ìœ„ì¹˜í•œ ëª¨ë“  í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì‹¤í–‰ í›„ì— ì‹¤í–‰ë˜ëŠ” ë©”ì„œë“œ
    - ë§¤ í…ŒìŠ¤íŠ¸ ë©”ì„œë“œë§ˆë‹¤ ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ìƒì„±(new)í•˜ì—¬ ì‹¤í–‰ -> ë¹„íš¨ìœ¨ì !

#### BeforeAll vs. BeforeEach

```java
@BeforeAll

@Test
@Test
@Test

------

@BeforeEach
@Test

@BeforeEach
@Test

@BeforeEach
@Test
```


- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë“¤ì´ @BeforeAll ì„ ì–¸ ì´í›„ ì¡°ê±´ë“¤ì— ëŒ€í•´ ì–´ë– í•œ ë³€ê²½ë„ í•˜ì§€ ì•ŠëŠ”ë‹¤!
    - BeforeAll
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ì¡°ê±´ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤!
    - BeforeEach
    - í…ŒìŠ¤íŠ¸ ë§¤ ì‹¤í–‰ì‹œë§ˆë‹¤ ì´ˆê¸°í™”


### 2-3. `@Disabled` annot.
- **í…ŒìŠ¤íŠ¸ë¥¼ í•˜ê³  ì‹¶ì§€ ì•Šì€** í´ë˜ì„œë‚˜ ë©”ì„œë“œì— ë¶™ì´ëŠ” ì–´ë…¸í…Œì´ì…˜

```java
class Example {
    @Test
    @Disabled("ë¬¸ì œê°€ í•´ê²°ë  ë•Œê¹Œì§€ í…ŒìŠ¤íŠ¸ ì¤‘ë‹¨")
    void test() {
        System.out.println("í…ŒìŠ¤íŠ¸1")
    }
    @Test
    void test() {
        System.out.println("í…ŒìŠ¤íŠ¸2")
    }
}
```

### 2-4. `@DisplayName` annot.
- ì–´ë–¤ í…ŒìŠ¤íŠ¸ì¸ì§€ ì‰½ê²Œ í‘œí˜„í•  ìˆ˜ ìˆë„ë¡ í•´ì¤Œ
- ê³µë°±, Emoji, íŠ¹ìˆ˜ë¬¸ì ë“±ì„ ëª¨ë‘ ì§€ì›

```java
@DisplayName("í…ŒìŠ¤íŠ¸ ì´ë¦„ ì •í•´")
class Example {
    @Test
    @DisplayName("ìš°ì•„í•œ í…ŒìŠ¤íŠ¸")
    void test() {
    }
}
```

### 2-5. `@RepeatedTest` annot.
- íŠ¹ì • í…ŒìŠ¤íŠ¸ë¥¼ **ë°˜ë³µ**ì‹œí‚¤ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©
    - ex. ì„±ëŠ¥ì ì¸ ì´ìŠˆë¥¼ í™•ì¸í•  ë•Œ
- ë°˜ë³µ íšŸìˆ˜ì™€ ë°˜ë³µ í…ŒìŠ¤íŠ¸ ì´ë¦„ ì„¤ì • ê°€ëŠ¥

```java
@RepeatedTest(10)
@DisplayName("ë°˜ë³µ í…ŒìŠ¤íŠ¸1")
void repeatedTest() {

}

@RepeatedTest(value = 10, name = '{displayName} ì¤‘ {currentRepetition} of {totalReptitions}')
@DisplayName("ë°˜ë³µ í…ŒìŠ¤íŠ¸2")
void repeatedTest() {

}
```

### 2-6. `@ParameterizedTest` annot.
- í…ŒìŠ¤íŠ¸ì— ì—¬ëŸ¬ ë‹¤ë¥¸ **ë§¤ê°œë³€ìˆ˜ë¥¼ ëŒ€ì…í•´ê°€ë©° ë°˜ë³µ ì‹¤í–‰**í•  ë•Œ ì‚¬ìš©
    - ë°˜ë³µë¬¸ ì‚¬ìš©ë³´ë‹¤ ê°€ë…ì„± í–¥ìƒ
    - í…ŒìŠ¤íŠ¸ ì„±ê²©, ëª©ì  ëª…ë£Œí™” ê°€ëŠ¥

```java
@ParameterizedTest
@CsvSource(value = {"ACE,ACE:12", "ACE,ACE,ACE:13", "ACE,ACE,TEN:12"}, delimeter = ':')
@DisplayName("ì—ì´ìŠ¤ ì¹´ë“œê°€ ì—¬ëŸ¬ ê°œì¼ ë•Œ í•© êµ¬í•˜ê¸°")
void calculateCardSumWhenAceIsTwo(final String input, final int expected) {
    for (final String number : inputs) {
        final CardNumber cardNumber = CardNumber.valueOf(number)
        dealer.receiveOneCard(new Card(cardNumber, CardType.CLOVER));
    }
    assertThat(dealer.calculateScore()).isEqaulTo(expected);
}
```

### 2-7. `@Nested`
- í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì•ˆì—ì„œ **ë‚´ë¶€ í´ë˜ìŠ¤ë¥¼ ì •ì˜**í•´ í…ŒìŠ¤íŠ¸ë¥¼ ê³„ì¸µí™” í•  ë•Œ ì‚¬ìš©
- ë‚´ë¶€í´ë˜ìŠ¤ëŠ” ë¶€ëª¨í´ë˜ìŠ¤ì˜ ë©¤ë²„ í•„ë“œì— ì ‘ê·¼ ê°€ëŠ¥
- Before / Afterì™€ ê°™ì€ ìƒëª…ì£¼ê¸° í…ŒìŠ¤íŠ¸ì— ê´€ê³„ëœ ë©”ì†Œë“œë“¤ë„ ê³„ì¸µì— ë§ì¶° ë™ì‘

```java
public class DisplayNameTest {

    @Test
    public void testAsuccess() { /* */ }

    @Test
    public void testAfail() { /* */ }

    @Test
    public void test1success() { /* */ }

    @Test
    public void test1success() { /* */ }

    @Test
    public void test2success() { /* */ }

    @Test
    public void test2fail() { /* */}
}
```

ì•„ë˜ì™€ ê°™ì´ UnitTest ë¦¬íŒ©í„°ë§ ê°€ëŠ¥

```java
public class DisplayNameTest {

    @Nested
    class testA {

        @Test
        public void success() { /* */ }

        @Test
        public void fail() { /* */ }
    }

    @Nested
    class testNumber {

        @Nested
        class test1 {

            @Test
            public void success() { /* */ }

            @Test
            public void fail() { /* */ }
        }

        @Nested
        class test2 {

            @Test
            public void success() { /* */ }

            @Test
            public void fail() { /* */ }

        }
    }
}
```

![image](https://github.com/ParkJiwoon/PrivateStudy/blob/master/images/nested-display-name-1.png?raw=true)

---

## 3. Assertions
- ì‚¬ì „ì  ì˜ë¯¸ : ì£¼ì¥, í–‰ì‚¬, ë‹¨ì •ë¬¸
- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì˜ ìˆ˜í–‰ **ê²°ê³¼ë¥¼ íŒë³„**í•˜ëŠ” ë©”ì„œë“œ
- ëª¨ë“  JUnit Jupiter AssertionsëŠ” `statc` ë©”ì„œë“œ


<ì•„ë˜ëŠ” JUnit5ì—ì„œ ì¶”ê°€ëœ ëª‡ê°€ì§€ ì‚¬í•­>

### 3-1. assertAll(executables...)
- ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ëŠ” **ëª¨ë“  í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ í•œ ë²ˆì— ì‹¤í–‰**
- **ì˜¤ë¥˜ê°€ ë‚˜ë„ ëê¹Œì§€ ì‹¤í–‰**í•œ ë’¤ í•œ ë²ˆì— ëª¨ì•„ì„œ ì¶œë ¥


```java
List<String> owners = Arrays.asList("Betty Davis", "Eduardo Rodriquez");

// assert
assertAll(
    () -> assertTrue(owners.contains("Betty Doe"), "Contains Betty Doe"),
    () -> assertTrue(owners.contains("John Doe"), "Contains John Doe"),
    () -> assertTrue(owners.contains("Eduardo Rodriquez"), "Eduardo Rodriquez")
);
```

### 3-2. assertThrows(expectedType, executable)
- **ì˜ˆì™¸ ë°œìƒì„ í™•ì¸**í•˜ëŠ” í…ŒìŠ¤íŠ¸
- executableì˜ ë¡œì§ì´ ì‹¤í–‰ë˜ëŠ” ë„ì¤‘ expectedTypeì˜ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ëŠ”ì§€ í™•ì¸

```java
//JUnit4
//ì˜ˆì™¸ê°€ ë°œìƒí•˜ëŠ”ì§€ ì—¬ë¶€ë§Œ ê²€ì¦ ê°€ëŠ¥
@Test(expected = Exception.class)
void create() throws Exception {
    ...
}

// JUnit5
// ì˜ˆì™¸ ë°œìƒ ê²€ì¦ + ì˜ˆì™¸ ìƒíƒœ ê²€ì¦
@Test
void exceptionThrow {
    Exception e = assertThrows(Exception.class,() -> new Test(-10));
    assertDoesNotThrow(() -> System.out.println("Do Something"));
}
```

### 3-3. assertTimeout(duration, executable)
- íŠ¹ì • ì‹œê°„ ì•ˆì— ì‹¤í–‰ì´ ì™„ë£Œë˜ëŠ”ì§€ í™•ì¸
- Duration : ì›í•˜ëŠ” ì‹œê°„
- Executable : í…ŒìŠ¤íŠ¸ í•  ë¡œì§

```java
    @Test
    @DisplayName("íƒ€ì„ì•„ì›ƒ ì¤€ìˆ˜")
    void assert_timeout1() {
        assertTimeout(Duration.ofMillis(100), () -> {
            new Study(10, 10);
            Thread.sleep(300);
        });
    void assert_timeout2() {
        assertTimeout(Duration.ofMinutes(2), () -> {
            new Study(10, 10);
            Thread.sleep(10);
        });
    }
```


## 4. Assumption

- ì „ì œë¬¸ì´ tureë¼ë©´ ì‹¤í–‰, falseë¼ë©´ ì¢…ë£Œ
- `assumeTure` : falseì¼ ë•Œ ì´í›„ **í…ŒìŠ¤íŠ¸ ì „ì²´**ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
- `assumingThat` : íŒŒë¼ë¯¸í„°ë¡œ **ì „ë‹¬ëœ ì½”ë“œë¸”ëŸ­ë§Œ** ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
    - CI ë“± íŠ¹ì • í™˜ê²½ì—ì„œë§Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ì•¼ í•˜ëŠ” ê²½ìš° ì‚¬ìš© ê°€ëŠ¥

```java
    void dev_env_only() {
        assumeTrue("DEV".equals(System.getenv("ENV")), () -> "ê°œë°œ í™˜ê²½ì´ ì•„ë‹™ë‹ˆë‹¤.");
        assertEqauls("A", "A"); //ìœ„ì—ê°€ falseë¼ë©´, ë‹¨ì •ë¬¸ì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
    void some_test() {
        assumingThat("DEV".equals(System.getenv("ENV")),
        () -> {
            assertEquals("A", "B"); //ë‹¨ì •ë¬¸ì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
        });
        assertEqauls("A", "A"); //ë‹¨ì •ë¬¸ì´ ì‹¤í–‰ë¨
    }
```
